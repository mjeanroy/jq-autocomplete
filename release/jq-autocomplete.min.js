/*! jq-autocomplete 2014-03-19 */

!function(a,b){"use strict";!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){var c="fixed",d="type",e="title",f=function(a){return a},g=function(){},h=function(){return!0},i=".jqauto",j="jqAutoComplete",k=13,l=40,m=38,n=9,o="jq-autocomplete-",p=o+"item",q=o+"item-active",r=o+"results",s=o+"results-list",t=o+"create-link",u=o+"create-form",v=o+"create-form-buttons",w=function(a,c){if(!a||!c)return a;for(var d=c.split("."),e=a,f=d.length,g=0;f-1>g;++g)if(e=e[d[g]],null===e||e===b)return"";return e[d[f-1]]},x=function(a){return a===b||null===a?a:parseInt(a,10)},y=function(a,b){return String.prototype.startsWith?a.startsWith(b):0===a.indexOf(b)};a.event.special.jqAutoCompleteRemoved={remove:function(a){a.handler&&a.handler()}};var z=function(b,c){var d=this;d.$input=a(c);var e=b.parseHtml?d.readData():{};d.opts=a.extend({},b,e),d.caches={},d.filter="",d.results=[],d.idx=-1,d.top=-1,d.left=-1,d.width=-1,d.timer=null,d.xhr=null};z.prototype={init:function(){var b=this;b.$ul=a("<ul></ul>").addClass(s);var d=b.opts.relativeTo,e=c,f=!(d!==c);if(!f){var g=d?a(d):b.$input.parent();g.css("position","relative"),e="absolute"}b.position=e,b.fixed=f,b.$results=a("<div></div>").addClass(r).append(b.$ul),b.opts.$createForm&&b.appendForm(),b.$input.after(b.$results),b.positionResult(),b.bind()},appendForm:function(){var b=this,c=b.$results,f=b.opts.createLabel;f&&(b.$link=a("<a></a>").attr("href","#").addClass(t).html(f).prependTo(c)),b.$form=a(b.opts.$createForm).clone().addClass(u).appendTo(c);var g=b.opts.submit,h=b.opts.cancel;if(g||h){var i=a("<div></div>").addClass(v).appendTo(b.$form);g&&a("<button></button>").attr(d,"submit").attr(e,g).addClass("btn").addClass("btn-success").html(g).appendTo(i),h&&(b.$cancel=a("<button></button>").attr(d,"button").attr(e,h).addClass("btn").addClass("btn-default").html(h).appendTo(i))}},readData:function(){var a=this.$input.data();return a.$createForm=a.createForm,delete a.createForm,a},positionResult:function(){var a=this,b=a.$input,c=a.fixed?b.offset():b.position(),d=b.outerWidth(),e=b.outerHeight(),f=c.left,g=c.top+e;(a.left!==f||a.top!==g||a.width!==d)&&(a.left=f,a.top=g,a.width=d,a.$results.css({position:a.position,left:f,top:g,width:d}))},bind:function(){var b=this,c=b.$input,d=b.$ul,e=function(a,b){a.preventDefault(),a.stopPropagation(),b&&a.stopImmediatePropagation()},f=function(c){var d=c.keyCode;if(d!==k&&d!==l&&d!==m){var e=a.trim(a(this).val());e.length>=b.opts.minSize?b.fetch(e):(b.filter=e,b.$hide(),b.clear())}},g=function(c){var d=c.keyCode;d===l?(e(c),b.highlight(b.idx+1)):d===m?(e(c),b.highlight(b.idx-1)):d===k?b.idx>=0&&b.idx<b.results.length&&(e(c,!0),b.select(b.idx),a(this).focus()):d===n&&b.select(b.idx)},h=function(){b.focus=!1;var c=a(this);setTimeout(function(){b&&!b.focus&&!b.$creation&&b.$ul&&(b.$hide(),b.item||b.autoSelect(a.trim(c.val())),b.opts.focusout.call(b,b.item))},200)},j=function(){b.focus=!0,!b.item&&b.results.length>0&&b.$show()};c.on("keyup"+i,f),c.on("keydown"+i,g),c.on("focusout"+i,h),c.on("focusin"+i,j);var o=function(){a(this).find("li").removeClass(q)},p=function(){b.select(x(a(this).attr("data-idx"))),b.$input.focus()};d.on("mouseenter"+i,o),d.on("click"+i,"li",p);var r=function(){b.destroy&&b.destroy(),b=null,c=null,d=null};c.on("jqAutoCompleteRemoved",r),b.bindForm()},bindForm:function(){var a=this;if(a.$link){var b=function(b){b.preventDefault(),a.showCreationForm()};a.$link.on("click"+i,b)}if(a.$cancel){var c=function(){a.hideCreationForm()};a.$cancel.on("click"+i,c)}if(a.$form){var d=function(b){b.preventDefault(),a.create()};a.$form.on("submit"+i,d)}},isEmpty:function(){return this.item===b||null===this.item},fetch:function(b){var c=this;if(c.filter===b)return void(c.isEmpty()&&c.$show());c.isEmpty()||c.opts.unSelect.call(c),c.item=null,c.filter=b,c.xhr&&(c.xhr.abort(),c.xhr=null),c.timer&&(clearTimeout(c.timer),c.timer=null);var d=b.toLowerCase();if(c.opts.cache&&c.caches[d])c.show(c.caches[d]);else{var e=function(){var b=c.opts,f={};f[b.filterName]=c.filter,b.limit>0&&(f[b.limitName]=b.limit),b.datas&&("object"==typeof b.datas?f=a.extend(f,b.datas):"function"==typeof b.datas&&(f=a.extend(f,b.datas.apply(c))));var g=b.dataType,h={url:b.url,type:b.method,dataType:g,data:f},i=(g||"").toLowerCase().indexOf("jsonp")>=0;i&&(h.jsonp=b.jsonp,h.jsonpCallback=b.jsonpCallback),c.xhr=a.ajax(h);var j=function(a){c.timer=null,c.xhr=null;var e=b.transformResults(a);b.cache&&(c.caches[d]=e),c.show(e)},k=function(){c=null,f=null,d=null,b=null};c.xhr.done(j),c.xhr.always(k),e=null};c.timer=setTimeout(e,200)}},clearCache:function(){this.caches={}},show:function(b){var c=this;if(c.results=b,0===b.length&&!c.$form)return void c.clear();c.$hide(),c.$ul.empty();for(var d=0,f=b.length;f>d;++d){var g=c.renderItem(b[d]);a("<li />").addClass(p).attr("data-idx",d).attr(e,g).html(g).appendTo(c.$ul)}c.$show()},hide:function(){this.$hide()},$show:function(){this.$visible||(this.$visible=!0,this.positionResult(),this.$results.show(),this.opts.onShown.call(this))},$hide:function(){this.$visible&&(this.$results.hide(),this.hideCreationForm(),this.opts.onHidden.call(this),this.$visible=!1)},showCreationForm:function(){var a=this;a.$form&&!a.$creation&&(a.$creation=!0,a.$ul.hide(),a.$link&&a.$link.hide(),a.$form.show(),a.$form.find('input[type="text"]').eq(0).val(a.$input.val()).focus()),a=null},hideCreationForm:function(){var a=this;a.$form&&a.$creation&&(a.$creation=!1,a.$form.hide(),a.$link&&a.$link.show(),a.$ul.show(),a.$input.focus()),a=null},create:function(){var c=this;if(c.$creation&&!c.$saving){c.$saving=!0;var d=c.$form.serializeArray(),e={};if(a.each(d,function(){e[this.name]!==b?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),!c.opts.isValid(e,c.$form))return void(c.$saving=!1);e=a.extend(e,c.opts.onSaved(e)||{});var f=c.opts.saveUrl||c.$form.attr("action")||c.opts.url,g=c.opts.saveMethod||c.$form.attr("method"),h=c.opts.saveDataType,i=c.opts.saveContentType;y(i,"application/json")&&JSON&&JSON.stringify&&(e=JSON.stringify(e));var j=a.ajax({url:f,type:g,dataType:h,contentType:i,data:e}),k=function(){c=null,d=null,e=null,j=null,l=null,m=null,n=null},l=function(a){c.opts.onSavedSuccess.apply(null,arguments),c.set(a),c.$hide()},m=function(){c.opts.onSavedFailed.apply(null,arguments)},n=function(){c.$saving=!1,k()};j.done(l),j.fail(m),j.always(n)}},set:function(a){var b=this;b.item=a,b.filter=b.renderItem(a),b.$input.val(b.filter),b.$hide(),b.idx=-1,b.opts.select.call(b,a)},get:function(){return this.item},renderItem:function(c){var d=this.opts.label,e=a.isFunction(d)?d.call(null,c):w(c,d);return(e===b||null===e)&&(e=""),e},select:function(a){a>=0&&a<this.results.length&&this.set(this.results[a])},autoSelect:function(a){for(var b=this.results,c=a.toLowerCase(),d=0,e=b.length;e>d;++d){var f=this.renderItem(b[d]).toLowerCase();if(f===c)return void this.select(d)}},highlight:function(a){var b=this,c=b.results.length;c&&(0>a?a=c-1:a>=c&&(a=0),b.$ul.find("li").removeClass(q).eq(a).addClass(q),b.idx=a)},clear:function(){var a=this;a.item!==b&&null!==a.item&&this.opts.unSelect.call(a),a.$hide(),a.$ul.empty(),a.results=[],a.idx=-1,a.item=null},empty:function(){this.clear(),this.$input.val(""),this.resetForm()},resetForm:function(){this.$form&&this.$form.find('input[type!="hidden"], select').each(function(){a(this).val("")})},unbind:function(){this.$input.off(i),this.$ul.off(i),this.unbindForm()},unbindForm:function(){var a=this;a.$form&&a.$form.off(),a.$cancel&&a.$cancel.off(),a.$link&&a.$link.off()},destroy:function(){var a=this;if(null!==a.opts){a.opts.onDestroyed.call(a),a.unbind(),a.timer&&clearTimeout(a.timer),a.xhr&&a.xhr.abort(),a.$link&&a.$link.remove(),a.$cancel&&a.$cancel.remove(),a.$form&&a.$form.remove(),a.$ul.remove(),a.$results.remove();for(var b in a)a.hasOwnProperty(b)&&(a[b]=null)}}},a.fn.jqAutoComplete=function(c){var d=this,e=a(this);return d.destroy=function(){var a=e.data(j);a&&a.destroy(),e.removeData(j)},a.each(["hide","show","clearCache","empty","clear","get","set"],function(a,c){d[c]=function(){var a=e.data(j),f=a[c].apply(a,arguments);return f!==b?f:d}}),d.each(function(){var b=a(this).data(j);if(!b){var d=a.extend({},a.fn.jqAutoComplete.options);"object"==typeof c&&(d=a.extend(d,c)),b=new z(d,this),b.init()}a(this).data(j,b)})},a.fn.jqAutoComplete.options={url:"",saveUrl:"",label:f,minSize:3,method:"GET",dataType:"json",jsonp:b,jsonpCallback:b,saveMethod:"",saveDataType:"json",saveContentType:"application/x-www-form-urlencoded; charset=UTF-8",filterName:"filter",limitName:"limit",limit:10,datas:null,cache:!1,$createForm:null,createLabel:"Not here? Create it!",cancel:"Cancel",submit:"Save",onSaved:f,onSavedSuccess:g,onSavedFailed:g,isValid:h,relativeTo:null,parseHtml:!0,transformResults:f,focusout:g,select:g,unSelect:g,onShown:g,onHidden:g,onDestroyed:g}})}(window,void 0);
//# sourceMappingURL=jq-autocomplete.min.map